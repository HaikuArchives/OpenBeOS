SubDir OBOS_TOP sources os kits kernel ;

KernelLd stage2
	:
	<$(SOURCE_GRIST)!boot!arch!$(OBOS_ARCH)>stage2.o
	<$(SOURCE_GRIST)!boot!arch!$(OBOS_ARCH)>stage2_asm.o
	<$(SOURCE_GRIST)!boot!arch!$(OBOS_ARCH)>smp_boot.o
	<$(SOURCE_GRIST)!boot!arch!$(OBOS_ARCH)>smp_trampoline.o
	libc.a
	:
	$(SUBDIR)/boot/arch/$(OBOS_ARCH)/stage2.ld 
	:
	-dN
	;
	
KernelLd kernel 
	:
	<$(SOURCE_GRIST)!core>cbuf.o 
	<$(SOURCE_GRIST)!core>console.o 
	<$(SOURCE_GRIST)!core>cpu.o 
	<$(SOURCE_GRIST)!core>debug.o 
	<$(SOURCE_GRIST)!core>elf.o
	<$(SOURCE_GRIST)!core>faults.o
	<$(SOURCE_GRIST)!core>gdb.o
	<$(SOURCE_GRIST)!core>heap.o
	<$(SOURCE_GRIST)!core>int.o
	<$(SOURCE_GRIST)!core>khash.o 
	<$(SOURCE_GRIST)!core>lock.o 
	<$(SOURCE_GRIST)!core>main.o 
	<$(SOURCE_GRIST)!core>misc.o
	<$(SOURCE_GRIST)!core>module.o 
	<$(SOURCE_GRIST)!core>port.o
	<$(SOURCE_GRIST)!core>queue.o 
	<$(SOURCE_GRIST)!core>sem.o 
	<$(SOURCE_GRIST)!core>smp.o
	<$(SOURCE_GRIST)!core>syscalls.o 
	<$(SOURCE_GRIST)!core>thread.o 
	<$(SOURCE_GRIST)!core>timer.o

	libbus.a
	libfs.a
	libvm.a
	lib$(OBOS_ARCH).a
	libdrivers.a
	libide.a
	libkeyboard.a
	libps2mouse.a
	libdriverscommon.a
	libc.a
	:
	$(SUBDIR)/core/arch/$(OBOS_ARCH)/kernel.ld 
	:
	-Bdynamic -export-dynamic -dynamic-linker /foo/bar
	;

#KernelLink kernel.so
#	:
#	$(SUBDIR)/core/arch/x86/kernel.ld 
#	:
#	libcore.a
#	libbus.a
#	linkhack.so
#	libfs.a
#	libvm.a
#	lib$(OBOS_ARCH).a
#	libdrivers.a
#	libide.a
#	libkeyboard.a
#	libps2mouse.a
#	libdriverscommon.a
#	:
#	-Bdynamic -shared -export-dynamic -dynamic-linker /foo/bar
#	;

#KernelLink iso9660
#	:
#	$(SUBDIR)/core/addons/ldscripts/$(OBOS_ARCH)/addon.ld
#	:
#	libiso9660.a
#	kernel.so
#	:
#	-Bdynamic -shared
#	;

#KernelLink isa
#	:
#	$(SUBDIR)/core/addons/ldscripts/$(OBOS_ARCH)/addon.ld
#	:
#	libisa_bus_manager.a
#	kernel.so
#	:
#	-Bdynamic -shared
#	;

#KerneStaticLib libglue.o
#	:
#	:
#	libglue_lib0.a
#	:
#	-r
#	;
#
#KernelLink libm.so
#	:
#	$(SUBDIR)/ldscripts/$(OBOS_ARCH)/library.ld
#	:
#	libglue.o
#	libmcommon.a
#	libmieee.a
#	libmcommon_source.a
#	libm$(OBOS_ARCH).a
#	:
#	-shared -soname libm.so
#	;
#
#KernelLink libc.so
#	:
#	$(SUBDIR)/ldscripts/$(OBOS_ARCH)/library.ld
#	:
#	libglue.o
#	libc_init.a
#	libstdio.a
#	libstdlib.a
#	libsystem.a
#	libunistd.a
#	liblocale.a
#	:
#	-shared -soname libc.so
#	;
#
#KernelLink libglue.o
#	:
#	:
#	libglue_crt0.a
#	:
#	-r
#	;

#KernelLink fibo
#	:
#	$(SUBDIR)/ldscripts/$(OBOS_ARCH)/app.ld
#	:
#	libglue.o
#	libfibo_main.a
#	libm.so
#	libc.so
#	:
#	;
	
#KernelLink false
#	:
#	$(SUBDIR)/ldscripts/$(OBOS_ARCH)/app.ld
#	:
#	libglue.o
#	libfalse_main.a
#	libm.so
#	libc.so
#	:
#	;
#
#KernelLink init 
#	:
#	$(SUBDIR)/ldscripts/$(OBOS_ARCH)/app.ld
#	:
#	libglue.o
#	libkinit.a
#	libm.so
#	libc.so
#	:
#	;

SubInclude OBOS_TOP sources os kits kernel boot ;
SubInclude OBOS_TOP sources os kits kernel core ;
SubInclude OBOS_TOP sources os kits kernel drivers ;
SubInclude OBOS_TOP sources os kits kernel global ;
SubInclude OBOS_TOP sources os kits kernel glue ;
SubInclude OBOS_TOP sources os kits kernel libc ;
SubInclude OBOS_TOP sources os kits kernel libm ;
#SubInclude OBOS_TOP sources os kits kernel prefs ;
